# Malware-Detection-API
## AWS-based Deep Learning PE Malware Detection Classifier

This project aims to detect malware in Portable Executable (PE) files using the MalConv architecture and deploy the model on AWS SageMaker for real-time inference. The model is trained on the EMBER dataset and deployed as a cloud API accessible via an endpoint. This project employs the PyTorch framework. For training an **ml.r5.xlarge** SageMaker notebook instance has been used, and for deployment an **ml.c4.xlarge** EC2 instance has been used. 

- The **S24_AISec_Midterm_Training_v1.ipynb** Jupyter Notebook contains the code for dataset preprocessing, model training, and evaluation. The MalConv architecture is built from scratch. 

- The **Inference-deployment-v1.ipynb** Jupyter Notebook includes code for inference and model deployment to an AWS SageMaker endpoint.

- **model_epoch_13.pt** and **model_epoch_8.pt** are model checkpoints. 

- The **model/code** folder contains the **inference.py** entrypoint script and a **requirements.txt** file for endpoint deployment.

- The **requirements.txt** file in the root directory contains required dependencies for the Streamlit client app (**app.py**).

### Client App

The client app takes an executable as input and outputs malware classification. To run the app,

1. Create a virtual environment with Python 3.6.13 in one of the following ways and activate it
 
       virtualenv -p python3.6.13 my_venv
   
       .\my_venv\Scripts\activate
    Or,
  
        conda create --name my_venv python=3.6.13
        conda activate my_venv

2. Install dependencies
    
        pip install -r requirements.txt

3. Add AWS credentials and endpoint name in the **app.py**
  
4. Run client app
   
        streamlit run app.py


![Untitled design](https://github.com/rara-by/Malware-Detection-API/assets/63100531/adbdccf9-cb34-41ba-8677-dd523ec756c5)


#### References:

  1. EMBER dataset: https://github.com/elastic/ember
  2. MalConv paper: https://arxiv.org/abs/1710.09435
